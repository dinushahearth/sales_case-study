{
	"name": "SCD Type 1",
	"properties": {
		"content": {
			"query": "------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n---Insert new records\nINSERT INTO Sales.dimCustomers\nSELECT *\nFROM Sales.ExCustomers as stg\nWHERE NOT EXISTS(\n    SELECT *\n    FROM Sales.dimCustomers AS dim WHERE dim.Customer_Name = stg.Customer_Name\n)\n\n---SCD Type 1\nUPDATE Sales.dimCustomers\nSET dim.Customer_Name = stg.Customer_Name,\n    dim.Phone =  stg.Phone ,\n    dim.Address_Line1 =  stg.Address_Line1,\n    dim.Address_Line2 =  stg.Address_Line2,\n    dim.City =  stg.City, \n    dim.State =  stg.State, \n    dim.Postal_Code =  stg.Postal_Code,\n    dim.Country =  stg.Country, \n    dim.Territory =  stg.Territory, \n    dim.Contact_Lastname =  stg.Contact_Lastname,\n    dim.Conact_Firstname =  stg.Conact_Firstname\nFROM Sales.dimCustomers dim inner join Sales.ExCustomers stg\nON dim.Customer_Name = stg.Customer_Name\nWHERE dim.Phone <> stg.Phone \nOR dim.Address_Line1 <> stg.Address_Line1 \nOR dim.Address_Line2 <> stg.Address_Line2\nOR dim.City <> stg.City \nOR dim.State <> stg.State \nOR dim.Postal_Code <> stg.Postal_Code\nOR dim.Country <> stg.Country \nOR dim.Territory <> stg.Territory \nOR dim.Contact_Lastname <> stg.Contact_Lastname\nOR dim.Conact_Firstname <> stg.Conact_Firstname\n\nALTER INDEX ALL ON  Sales.dimCustomers REBUILD\n------------------------------------------------------------------------------------------------------------------------------------------------------------\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "sales_cg",
				"poolName": "sales_cg"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}